#!/bin/bash

function check_down () {
    if [ kill -0 ${PID} = 0 ]; then
        return false
    else
        return true
    fi
}
function wait_until_down() {
    while [ check_down = false ]; do
        sleep 1
    done
}

function start() {
    echo "Start\n" > ~/mc.txt

    if [[ ! -p ${command_fifo} ]]; then
        mkfifo ${command_fifo}
    fi

    tail -f ${command_fifo} | ${executable} &
    local PID=$!
    wait_until_down
}

function stop() {
    echo "stop" > ${command_fifo}
    wait_until_down
}

function reload() {
    echo "reload" > ${command_fifo}
}
case "$1" in
  start)
    start
    ;;
  stop)
    stop
    ;;
  reload)
    reload
    ;;
  *)
    echo "Usage: $0 {start|stop|restart|reload}"
esac